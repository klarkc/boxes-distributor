<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../polymer/polymer.html">

<!--
This element distributes boxes with a ideal layout to use the maximum of available space in outer boxes

Example:

    <boxes-box
                       box-width='54'
                       box-height='42'
                       >
    </boxes-box>

@demo demo/index.html
@hero hero.svg
-->

<dom-module id="boxes-box">
  <template>
    <style>
      :host {
        display: none;
        box-sizing: border-box;
        position: absolute;
        overflow: hidden;
        border: 1px solid white;
        text-align: center;
        cursor: pointer;
      }

      /* Disable text selection */
      :host {
        -webkit-touch-callout: none; /* iOS Safari */
        -webkit-user-select: none;   /* Chrome/Safari/Opera */
        -khtml-user-select: none;    /* Konqueror */
        -moz-user-select: none;      /* Firefox */
        -ms-user-select: none;       /* Internet Explorer/Edge */
        user-select: none;
      }
    </style>
    <span>{{box._id}}</span>
  </template>

  <script>
    Polymer({
      is: 'boxes-box',

      properties: {
         /**
         * `box` the box object
         */
        box: {
          type: Object,
          observer: '_updatedBox'
        },

        /**
         * `scale` the scale multiplier of all the sizes
         */
        scale: {
          type: Number,
          value: 1
        }
      },

      _updatedBox: function(box) {
        //console.log('updated box', box);
        this.style.width = box.w * this.scale + 'px';
        this.style.height = box.h * this.scale + 'px';
        this.style.lineHeight = box.h * this.scale + 'px';
        this.style.backgroundColor = this._getRandomColor();
        if(box.fit) {
          this.style.display = 'block';
          this.style.left = box.fit.x * this.scale + 'px';
          this.style.top = box.fit.y * this.scale + 'px';
        } else {
          this.style.display = 'none';
        }
      },

      _getRandomColor: function() {
        let letters = '0123456789ABCDEF'.split('');
        let color = '#';
        for (var i = 0; i < 6; i++ ) {
          color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
      }
    });
  </script>
</dom-module>
